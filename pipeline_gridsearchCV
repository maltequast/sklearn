import numpy as np
from sklearn.preprocessing import OneHotEncoder
from sklearn.compose import ColumnTransformer
from sklearn.impute import SimpleImputer
from sklearn.preprocessing import StandardScaler
from sklearn.pipeline import Pipeline
from sklearn.linear_model import LogisticRegression


numeric_features = X.columns.to_list()
numeric_transformer = Pipeline(steps=[
    ('imputer', SimpleImputer(strategy='median')),
    ('scaler', StandardScaler())])

preprocessor = ColumnTransformer(
    transformers=[
        ('num', numeric_transformer, numeric_features),
    ])
        
        
clf = Pipeline(steps=[('preprocessor', preprocessor),
                      ('logreg', LogisticRegression())
                  ]) 

param_grid={'logreg__C': np.logspace(-4, 4, 4)}

search = GridSearchCV(clf, param_grid, n_jobs=-1)
# clf = clf.fit(X,Y)
search.fit(X, Y)
print("Best parameter (CV score=%0.3f):" % search.best_score_)
print(search.best_params_)
